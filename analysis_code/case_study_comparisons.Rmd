---
title: "case_study_comparisons"
author: "Marina Chaji"
date: "2024-01-19"
output: html_document
---




```{r setup, echo=FALSE}

library(FishSET)
library(BSDA) # z-tests 
library(plyr)
library(dplyr)
library(readr)
library(knitr) #creates output for tables when knitting 
library(here)

here::i_am("analysis_code/case_study_comparisons.Rmd")
# helper functions
source(here("analysis_code", "format_helpers.R"))

project <- "scallop0322"
pounds_to_kg<-2.20462
# disable scientific notation
options(scipen=999)

```


## About 
 
This report uses data sets from the tiny reports to estimate based on our five key metrics: trips, ex-vessel scallop revenue, scallop landings, operating profit, and revenue per day across the Limited Access and General Category-IFQ fleets. The Limited Access fleet is characterized by metiers, Access Area (AA) & Days-at-Sea(DAS). We also test for equality of means in areas excluded as regulatory processes occur using z-tests between phases, i.e., Call Area(s) to Wind Energy Area(s) and Wind Energy Area(s) to Lease Area(s) in the New York Bight (NY) & Central Atlantic (CA) regions. 

The .RDS datasets loaded in the "load_in_data" chunk are generated by running the "knit_tiny_scallop_analysis_loop.R" with the following options


```{r pre, eval=FALSE}

AADAS_Vals_to_loop<-c(TRUE,FALSE) 
input_shapefile_vals_to_loop2<-c("wind_NY1.RDS","wind_NY2.RDS","wind_NY3.RDS","wind_Central_Atlantic_1.RDS", "wind_Central_Atlantic_2.RDS","wind_Central_Atlantic_3.RDS")

```

Note to find outputs used in tables throughout the methods paper use the following to search "Provides outputs for" the text after will provide the appropriate table number, fleet, and variable(s) used.





```{r load_in_data}

#Load GCIFQ data 

NY1_GC <- readRDS(here::here("data","main","casestudies","casestudy_gc_NY1_2023_11_06.Rds"))
NY2_GC <- readRDS(here::here("data","main","casestudies","casestudy_gc_NY2_2023_11_06.Rds"))
NY3_GC <- readRDS(here::here("data","main","casestudies","casestudy_gc_NY3_2023_11_06.Rds"))

CA1_GC <- readRDS(here::here("data","main","casestudies","casestudy_gc_CA1_2023_11_06.Rds"))
CA2_GC <- readRDS(here::here("data","main","casestudies","casestudy_gc_CA2_2023_11_06.Rds"))
CA3_GC <- readRDS(here::here("data","main","casestudies","casestudy_gc_CA3_2023_11_06.Rds"))



#Load LA data 


NY1_LA <- readRDS(here::here("data","main","casestudies","casestudy_LA_NY1_2023_11_06.Rds"))
NY2_LA <- readRDS(here::here("data","main","casestudies","casestudy_LA_NY2_2023_11_06.Rds"))
NY3_LA <- readRDS(here::here("data","main","casestudies","casestudy_LA_NY3_2023_11_06.Rds"))

CA1_LA <- readRDS(here::here("data","main","casestudies","casestudy_LA_CA1_2023_11_06.Rds"))
CA2_LA <- readRDS(here::here("data","main","casestudies","casestudy_LA_CA2_2023_11_06.Rds"))
CA3_LA <- readRDS(here::here("data","main","casestudies","casestudy_LA_CA3_2023_11_06.Rds"))

```


GC-IFQ data.  


```{r}

## New York Bight 

Inside_NY1_GC <- NY1_GC %>% filter(in_closure == "TRUE")

Inside_NY2_GC <- NY2_GC %>% filter(in_closure == "TRUE")

Inside_NY3_GC <- NY3_GC %>% filter(in_closure == "TRUE")


dropped_values_NY_1_2_GC <- anti_join(Inside_NY1_GC, Inside_NY2_GC, by = c("TRIPID" = "TRIPID"))

dropped_values_NY_2_3_GC <- anti_join(Inside_NY2_GC, Inside_NY3_GC, by = c("TRIPID" = "TRIPID"))



## Central Atlantic 

Inside_CA1_GC <- CA1_GC %>% filter(in_closure == "TRUE")

Inside_CA2_GC <- CA2_GC %>% filter(in_closure == "TRUE")

Inside_CA3_GC <- CA3_GC %>% filter(in_closure == "TRUE")


dropped_values_CA_1_2_GC <- anti_join(Inside_CA1_GC, Inside_CA2_GC, by = c("TRIPID" = "TRIPID"))

dropped_values_CA_2_3_GC <- anti_join(Inside_CA2_GC, Inside_CA3_GC, by = c("TRIPID" = "TRIPID"))

dropped_values_CA_1_3_GC <- anti_join(Inside_CA1_GC, Inside_CA3_GC, by = c("TRIPID" = "TRIPID"))


```

dropped_values_NY_1_2_GC contains observations for the GC fleet that are in the NYB Call Area (1), but not in the NYB Wind Energy Area (2).  dropped_values_NY_2_3_GC contains obsevations for the GC fleet that are in the NYB Wind Energy Area (2), but not in the NYB Lease Areas (3). Other "dropped_values" objects are named analogously.




Limited Access
```{r}

## New York Bight 

Inside_NY1_LA <- NY1_LA %>% filter(in_closure == "TRUE")

Inside_NY2_LA <- NY2_LA %>% filter(in_closure == "TRUE")

Inside_NY3_LA <- NY3_LA %>% filter(in_closure == "TRUE")


dropped_values_NY_1_2_LA <- anti_join(Inside_NY1_LA, Inside_NY2_LA, by = c("TRIPID" = "TRIPID"))

dropped_values_NY_2_3_LA <- anti_join(Inside_NY2_LA, Inside_NY3_LA, by = c("TRIPID" = "TRIPID"))



## Central Atlantic 

Inside_CA1_LA <- CA1_LA %>% filter(in_closure == "TRUE")

Inside_CA2_LA <- CA2_LA %>% filter(in_closure == "TRUE")

Inside_CA3_LA <- CA3_LA %>% filter(in_closure == "TRUE")


dropped_values_CA_1_2_LA <- anti_join(Inside_CA1_LA, Inside_CA2_LA, by = c("TRIPID" = "TRIPID"))

dropped_values_CA_2_3_LA <- anti_join(Inside_CA2_LA, Inside_CA3_LA, by = c("TRIPID" = "TRIPID"))

dropped_values_CA_1_3_LA <- anti_join(Inside_CA1_LA, Inside_CA3_LA, by = c("TRIPID" = "TRIPID"))

```

dropped_values_CA_1_2_LA contains observations for the LA fleet that are in the Central Atlantic Call Area (1), but not in the Draft Central Atlantic Wind Energy Area (2).  dropped_values_CA_1_3_LA contains obsevations for the LA  fleet that are in the Central Atlantic Call Area (1), but not in the Finalized Central Atlantic Wind Energy Area (3). Other "dropped_values" objects are named analogously.



```{r}
#tests
view_lon_lat(Inside_CA2_LA, lon = "DDLON", lat ="DDLAT")
view_lon_lat(dropped_values_NY_2_3_LA, lon = "DDLON", lat ="DDLAT")
view_lon_lat(Inside_CA3_LA, lon = "DDLON", lat ="DDLAT")

```

```{r}

## New York Bight


 Inside_NY1_AA <- Inside_CA1_LA %>% filter(fleet == "Access Area") 
 Inside_CA1_DAS <- Inside_CA1_LA %>% filter(fleet == "Days at Sea") 
 
 Inside_NY2_AA <- Inside_CA2_LA %>% filter(fleet == "Access Area") 
 Inside_NY2_DAS <- Inside_CA2_LA %>% filter(fleet == "Days at Sea") 
 
 Inside_NY3_AA <- Inside_CA3_LA %>% filter(fleet == "Access Area") 
 Inside_NY3_DAS <- Inside_CA3_LA %>% filter(fleet == "Days at Sea") 
 
 
 dropped_values_NY_1_2_AA <- dropped_values_NY_1_2_LA %>% filter(fleet == "Access Area") 
 dropped_values_NY_1_2_DAS <- dropped_values_NY_1_2_LA %>% filter(fleet == "Days at Sea") 
 
 dropped_values_NY_2_3_AA <- dropped_values_NY_2_3_LA %>% filter(fleet == "Access Area") 
 dropped_values_NY_2_3_DAS <- dropped_values_NY_2_3_LA %>% filter(fleet == "Days at Sea") 

 
 dropped_values_NY_1_3_AA <- dropped_values_NY_1_2_LA %>% filter(fleet == "Access Area") 
 dropped_values_NY_1_3_DAS <- dropped_values_NY_1_2_LA %>% filter(fleet == "Days at Sea") 



## Central Atlantic


Inside_CA1_AA <- Inside_CA1_LA %>% filter(fleet == "Access Area") 
Inside_CA1_DAS <- Inside_CA1_LA %>% filter(fleet == "Days at Sea") 
 
Inside_CA2_AA <- Inside_CA2_LA %>% filter(fleet == "Access Area") 
Inside_CA2_DAS <- Inside_CA2_LA %>% filter(fleet == "Days at Sea") 
 
Inside_CA3_AA <- Inside_CA3_LA %>% filter(fleet == "Access Area") 
Inside_CA3_DAS <- Inside_CA3_LA %>% filter(fleet == "Days at Sea") 
 
 
dropped_values_CA_1_2_AA <- dropped_values_CA_1_2_LA %>% filter(fleet == "Access Area") 
dropped_values_CA_1_2_DAS <- dropped_values_CA_1_2_LA %>% filter(fleet == "Days at Sea") 
 
dropped_values_CA_2_3_AA <- dropped_values_CA_2_3_LA %>% filter(fleet == "Access Area") 
dropped_values_CA_2_3_DAS <- dropped_values_CA_2_3_LA %>% filter(fleet == "Days at Sea") 

dropped_values_CA_1_3_AA <- dropped_values_CA_1_3_LA %>% filter(fleet == "Access Area") 
dropped_values_CA_1_3_DAS <- dropped_values_CA_1_3_LA %>% filter(fleet == "Days at Sea") 



```
# New York Bight (NY) Comparisons


## Aggregate Scallop revenue and Operating Profit by NY 1, 2, and 3 and dropped values. GC fleet
Total revenue and operating profits
```{r}
 

 Inside_NY1_GC %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=sum(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=sum(OPERATING_PROFIT_2022_win), count_PERMITs=n_distinct(PERMIT.y))



 Inside_NY2_GC %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=sum(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=sum(OPERATING_PROFIT_2022_win), count_PERMITs=n_distinct(PERMIT.y))

 Inside_NY3_GC %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=sum(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=sum(OPERATING_PROFIT_2022_win), count_PERMITs=n_distinct(PERMIT.y))




 dropped_values_NY_1_2_GC %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=sum(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=sum(OPERATING_PROFIT_2022_win), count_PERMITs=n_distinct(PERMIT.y))

 dropped_values_NY_2_3_GC %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=sum(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=sum(OPERATING_PROFIT_2022_win), count_PERMITs=n_distinct(PERMIT.y))


```


## Average Winsorized Scallop revenue and Operating Profit by NY 1, 2, and 3 and dropped values. GC fleet

Section 4.2 The Adaptive Wind Development Processes -  New York Bight - Code chunk below creates output for Table 5. GC-IFQ Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for the New York Bight region.


```{r}

 Inside_NY1_GC %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=mean(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=mean(OPERATING_PROFIT_2022_win), LANDED_win=mean(LANDED_win),VPUE_win=mean(VPUE_win)  )

 Inside_NY2_GC %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=mean(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=mean(OPERATING_PROFIT_2022_win), LANDED_win=mean(LANDED_win),VPUE_win=mean(VPUE_win)  )

 Inside_NY3_GC %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=mean(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=mean(OPERATING_PROFIT_2022_win), LANDED_win=mean(LANDED_win),VPUE_win=mean(VPUE_win)  )


 dropped_values_NY_1_2_GC %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=mean(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=mean(OPERATING_PROFIT_2022_win), LANDED_win=mean(LANDED_win),VPUE_win=mean(VPUE_win)  )


 dropped_values_NY_2_3_GC %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(), DOLLAR_2022_win=mean(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=mean(OPERATING_PROFIT_2022_win), LANDED_win=mean(LANDED_win),VPUE_win=mean(VPUE_win)  )
```



## Aggregate Scallop revenue and Operating Profit by NY 1, 2, and 3 and dropped values. LA fleet
Total revenue and operating profits
```{r}
 

 Inside_NY1_LA %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=sum(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=sum(OPERATING_PROFIT_2022_win), count_PERMITs=n_distinct(PERMIT.y))



 Inside_NY2_LA %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=sum(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=sum(OPERATING_PROFIT_2022_win), count_PERMITs=n_distinct(PERMIT.y))

 Inside_NY3_LA %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=sum(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=sum(OPERATING_PROFIT_2022_win), count_PERMITs=n_distinct(PERMIT.y))




 dropped_values_NY_1_2_LA %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=sum(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=sum(OPERATING_PROFIT_2022_win), count_PERMITs=n_distinct(PERMIT.y))

 dropped_values_NY_2_3_LA %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=sum(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=sum(OPERATING_PROFIT_2022_win), count_PERMITs=n_distinct(PERMIT.y))


```



## Average Winsorized Revenue, Operating Profit, Landed, and VPUE in closures by fleet LA 

Section 4.2 The Adaptive Wind Development Processes -  New York Bight - Code chunk below creates output for Table 6. Limited Access (DAS) Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for New York Bight.; Table 7. Limited Access (Access Area) Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for New York Bight.


```{r}

 Inside_NY1_LA %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=mean(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=mean(OPERATING_PROFIT_2022_win), LANDED_win=mean(LANDED_win),VPUE_win=mean(VPUE_win))



 Inside_NY2_LA %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=mean(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=mean(OPERATING_PROFIT_2022_win), LANDED_win=mean(LANDED_win),VPUE_win=mean(VPUE_win))

 Inside_NY3_LA %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=mean(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=mean(OPERATING_PROFIT_2022_win), LANDED_win=mean(LANDED_win),VPUE_win=mean(VPUE_win))




 dropped_values_NY_1_2_LA %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=mean(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=mean(OPERATING_PROFIT_2022_win), LANDED_win=mean(LANDED_win),VPUE_win=mean(VPUE_win))



 dropped_values_NY_2_3_LA %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=mean(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=mean(OPERATING_PROFIT_2022_win), LANDED_win=mean(LANDED_win),VPUE_win=mean(VPUE_win))





```


## NY GC-IFQ Revenue Z-Tests 

Section 4.2 The Adaptive Wind Development Processes -  New York Bight - Code chunk below creates output for Table 5. GC-IFQ Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for the New York Bight region.

```{r, NY_GC_Revenue_tests}
## Phase 1

BSDA::z.test(dropped_values_NY_1_2_GC$DOLLAR_2022_win,
  y = Inside_NY2_GC$DOLLAR_2022_win,
  sigma.x = sd(dropped_values_NY_1_2_GC$DOLLAR_2022_win),
  sigma.y = sd(Inside_NY2_GC$DOLLAR_2022_win),
  alternative = c("two.sided"),
  conf.level = 0.99)

## Phase 2

BSDA::z.test(dropped_values_NY_2_3_GC$DOLLAR_2022_win,
  y = Inside_NY3_GC$DOLLAR_2022_win,
  sigma.x = sd(dropped_values_NY_2_3_GC$DOLLAR_2022_win),
  sigma.y = sd(Inside_NY3_GC$DOLLAR_2022_win),
  alternative = c("two.sided"),
  conf.level = 0.99)



```


## NY Limited Access Revenue z-tests

Section 4.2 The Adaptive Wind Development Processes -  New York Bight - Code chunk below creates output for Table 6. Limited Access (DAS) Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for New York Bight.; Table 7. Limited Access (Access Area) Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for New York Bight.


```{r, NY_LA_Revenue_tests}

# Access Area 
## Phase 1 to 2
BSDA::z.test(dropped_values_NY_1_2_AA$DOLLAR_2022_win,
  y = Inside_NY2_AA$DOLLAR_2022_win,
  sigma.x = sd(dropped_values_NY_1_2_AA$DOLLAR_2022_win),
  sigma.y = sd(Inside_NY2_AA$DOLLAR_2022_win),
  alternative = c("two.sided"),
  conf.level = 0.99)

## Phase 2 to 3
BSDA::z.test(dropped_values_NY_2_3_AA$DOLLAR_2022_win,
  y = Inside_NY3_AA$DOLLAR_2022_win,
  sigma.x = sd(dropped_values_NY_2_3_AA$DOLLAR_2022_win),
  sigma.y = sd(Inside_NY2_AA$DOLLAR_2022_win),
  alternative = c("two.sided"),
  conf.level = 0.99)


# Days-at-Sea
## Phase 1 to 2

BSDA::z.test(dropped_values_NY_1_2_DAS$DOLLAR_2022_win,
  y = Inside_NY2_DAS$DOLLAR_2022_win,
  sigma.x = sd(dropped_values_NY_1_2_DAS$DOLLAR_2022_win),
  sigma.y = sd(Inside_NY2_DAS$DOLLAR_2022_win),
  alternative = c("two.sided"),
  conf.level = 0.99)


## Phase 2 to 3
BSDA::z.test(dropped_values_NY_2_3_DAS$DOLLAR_2022_win,
  y = Inside_NY3_DAS$DOLLAR_2022_win,
  sigma.x = sd(dropped_values_NY_2_3_DAS$DOLLAR_2022_win),
  sigma.y = sd(Inside_NY2_DAS$DOLLAR_2022_win),
  alternative = c("two.sided"),
  conf.level = 0.99)
```




## NY GC-IFQ Landed z-tests

Section 4.2 The Adaptive Wind Development Processes -  New York Bight - Code chunk below creates output for Table 5. GC-IFQ Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for the New York Bight region.


```{r, NY_GC_Landed_tests}
## Phase 1

BSDA::z.test(dropped_values_NY_1_2_GC$LANDED_win,
  y = Inside_NY2_GC$LANDED_win,
  sigma.x = sd(dropped_values_NY_1_2_GC$LANDED_win),
  sigma.y = sd(Inside_NY2_GC$LANDED_win),
  alternative = c("two.sided"),
  conf.level = 0.99)


## Phase 2
BSDA::z.test(dropped_values_NY_2_3_GC$LANDED_win,
  y = Inside_NY3_GC$LANDED_win,
  sigma.x = sd(dropped_values_NY_2_3_GC$LANDED_win),
  sigma.y = sd(Inside_NY3_GC$LANDED_win),
  alternative = c("two.sided"),
  conf.level = 0.99)


```



## NY Limited Access Landed z-tests

Section 4.2 The Adaptive Wind Development Processes -  New York Bight - Code chunk below creates output for Table 6. Limited Access (DAS) Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for New York Bight.; Table 7. Limited Access (Access Area) Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for New York Bight.


```{r, NY_LA_Landed_tests}

# Access Area 
## Phase 1 to 2
BSDA::z.test(dropped_values_NY_1_2_AA$LANDED_win,
  y = Inside_NY2_AA$LANDED_win,
  sigma.x = sd(dropped_values_NY_1_2_AA$LANDED_win),
  sigma.y = sd(Inside_NY2_AA$LANDED_win),
  alternative = c("two.sided"),
  conf.level = 0.99)

## Phase 2 to 3
BSDA::z.test(dropped_values_NY_2_3_AA$LANDED_win,
  y = Inside_NY3_AA$LANDED_win,
  sigma.x = sd(dropped_values_NY_2_3_AA$LANDED_win),
  sigma.y = sd(Inside_NY2_AA$LANDED_win),
  alternative = c("two.sided"),
  conf.level = 0.99)


# Days-at-Sea
## Phase 1 to 2

BSDA::z.test(dropped_values_NY_1_2_DAS$LANDED_win,
  y = Inside_NY2_DAS$LANDED_win,
  sigma.x = sd(dropped_values_NY_1_2_DAS$LANDED_win),
  sigma.y = sd(Inside_NY2_DAS$LANDED_win),
  alternative = c("two.sided"),
  conf.level = 0.99)


## Phase 2 to 3


BSDA::z.test(dropped_values_NY_2_3_DAS$LANDED_win,
  y = Inside_NY3_DAS$LANDED_win,
  sigma.x = sd(dropped_values_NY_2_3_DAS$LANDED_win),
  sigma.y = sd(Inside_NY2_DAS$LANDED_win),
  alternative = c("two.sided"),
  conf.level = 0.99)



```






## NY GCIFQ Operating Profit Z-Tests 

Section 4.2 The Adaptive Wind Development Processes -  New York Bight - Code chunk below creates output for Table 5. GC-IFQ Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for the New York Bight region.



```{r, NY_GC_Operating_profit_tests}
# Phase 1 to 2 

BSDA::z.test(dropped_values_NY_1_2_GC$OPERATING_PROFIT_2022_win,
  y = Inside_NY2_GC$OPERATING_PROFIT_2022_win,
  sigma.x = sd(dropped_values_NY_1_2_GC$OPERATING_PROFIT_2022_win),
  sigma.y = sd(Inside_NY2_GC$OPERATING_PROFIT_2022_win),
  alternative = c("two.sided"),
  conf.level = 0.99)


# Phase 2 to 3 

BSDA::z.test(dropped_values_NY_2_3_GC$OPERATING_PROFIT_2022_win,
  y = Inside_NY3_GC$OPERATING_PROFIT_2022_win,
  sigma.x = sd(dropped_values_NY_2_3_GC$OPERATING_PROFIT_2022_win),
  sigma.y = sd(Inside_NY3_GC$OPERATING_PROFIT_2022_win),
  alternative = c("two.sided"),
  conf.level = 0.99)
```

## NY Limited Access Operating Profit z-tests 

Section 4.2 The Adaptive Wind Development Processes -  New York Bight - Code chunk below creates output for Table 5. GC-IFQ Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for the New York Bight region.

```{r, NY_LA_Operating_profit_tests}

# Access Area 
## Phase 1 to 2
BSDA::z.test(dropped_values_NY_1_2_AA$OPERATING_PROFIT_2022_win,
  y = Inside_NY2_AA$OPERATING_PROFIT_2022_win,
  sigma.x = sd(dropped_values_NY_1_2_AA$OPERATING_PROFIT_2022_win),
  sigma.y = sd(Inside_NY2_AA$OPERATING_PROFIT_2022_win),
  alternative = c("two.sided"),
  conf.level = 0.99)

## Phase 2 to 3
BSDA::z.test(dropped_values_NY_2_3_AA$OPERATING_PROFIT_2022_win,
  y = Inside_NY3_AA$OPERATING_PROFIT_2022_win,
  sigma.x = sd(dropped_values_NY_2_3_AA$OPERATING_PROFIT_2022_win),
  sigma.y = sd(Inside_NY3_AA$OPERATING_PROFIT_2022_win),
  alternative = c("two.sided"),
  conf.level = 0.99)


# Days-at-Sea
## Phase 1 to 2
BSDA::z.test(dropped_values_NY_1_2_DAS$OPERATING_PROFIT_2022_win,
  y = Inside_NY2_DAS$OPERATING_PROFIT_2022_win,
  sigma.x = sd(dropped_values_NY_1_2_DAS$OPERATING_PROFIT_2022_win),
  sigma.y = sd(Inside_NY2_DAS$OPERATING_PROFIT_2022_win),
  alternative = c("two.sided"),
  conf.level = 0.99)


## Phase 2 to 3
BSDA::z.test(dropped_values_NY_2_3_DAS$OPERATING_PROFIT_2022_win,
  y = Inside_NY3_DAS$OPERATING_PROFIT_2022_win,
  sigma.x = sd(dropped_values_NY_2_3_DAS$OPERATING_PROFIT_2022_win),
  sigma.y = sd(Inside_NY3_DAS$OPERATING_PROFIT_2022_win),
  alternative = c("two.sided"),
  conf.level = 0.99)



```




## NY GCIFQ VPUE Z-Tests 

Section 4.2 The Adaptive Wind Development Processes -  New York Bight - Code chunk below creates output for Table 5. GC-IFQ Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for the New York Bight region.




```{r, NY_GC_VPUE_tests}
# Phase 1 to 2 
BSDA::z.test(dropped_values_NY_1_2_GC$VPUE_win,
  y = Inside_NY2_GC$VPUE_win,
  sigma.x = sd(dropped_values_NY_1_2_GC$VPUE_win),
  sigma.y = sd(Inside_NY2_GC$VPUE_win),
  alternative = c("two.sided"),
  conf.level = 0.99)


# Phase 2 to 3 
BSDA::z.test(dropped_values_NY_2_3_GC$VPUE_win,
  y = Inside_NY3_GC$VPUE_win,
  sigma.x = sd(dropped_values_NY_2_3_GC$VPUE_win),
  sigma.y = sd(Inside_NY3_GC$VPUE_win),
  alternative = c("two.sided"),
  conf.level = 0.99)
```



## NY Limited Access VPUE z-tests

Section 4.2 The Adaptive Wind Development Processes -  New York Bight - Code chunk below creates output for Table 6. Limited Access (DAS) Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for New York Bight.; Table 7. Limited Access (Access Area) Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for New York Bight.


```{r, NY_LA_VPUE_tests}
# LA 
## Phase 1 to 2

BSDA::z.test(dropped_values_NY_1_2_LA$VPUE_win,
  y = Inside_NY2_LA$VPUE_win,
  sigma.x = sd(dropped_values_NY_1_2_LA$VPUE_win),
  sigma.y = sd(Inside_NY2_LA$VPUE_win),
  alternative = c("two.sided"),
  conf.level = 0.99)

## Phase 2 to 3
BSDA::z.test(dropped_values_NY_2_3_LA$VPUE_win,
  y = Inside_NY3_LA$VPUE_win,
  sigma.x = sd(dropped_values_NY_2_3_LA$VPUE_win),
  sigma.y = sd(Inside_NY3_LA$VPUE_win),
  alternative = c("two.sided"),
  conf.level = 0.99)



# Access Area 
## Phase 1 to 2
BSDA::z.test(dropped_values_NY_1_2_AA$VPUE_win,
  y = Inside_NY2_AA$VPUE_win,
  sigma.x = sd(dropped_values_NY_1_2_AA$VPUE_win),
  sigma.y = sd(Inside_NY2_AA$VPUE_win),
  alternative = c("two.sided"),
  conf.level = 0.99)

## Phase 2 to 3
BSDA::z.test(dropped_values_NY_2_3_AA$VPUE_win,
  y = Inside_NY3_AA$VPUE_win,
  sigma.x = sd(dropped_values_NY_2_3_AA$VPUE_win),
  sigma.y = sd(Inside_NY3_AA$VPUE_win),
  alternative = c("two.sided"),
  conf.level = 0.99)


# Days-at-Sea
## Phase 1 to 2
BSDA::z.test(dropped_values_NY_1_2_DAS$VPUE_win,
  y = Inside_NY2_DAS$VPUE_win,
  sigma.x = sd(dropped_values_NY_1_2_DAS$VPUE_win),
  sigma.y = sd(Inside_NY2_DAS$VPUE_win),
  alternative = c("two.sided"),
  conf.level = 0.99)


## Phase 2 to 3
BSDA::z.test(dropped_values_NY_2_3_DAS$VPUE_win,
  y = Inside_NY3_DAS$VPUE_win,
  sigma.x = sd(dropped_values_NY_2_3_DAS$VPUE_win),
  sigma.y = sd(Inside_NY3_DAS$VPUE_win),
  alternative = c("two.sided"),
  conf.level = 0.99)



```


# Central Atlantic Section 


## Aggregate Scallop Revenue and Operating Profit CA1, CA2, and CA3 and the Dropped Values from 1-3 for the LA Fleet

```{r}
 Inside_CA1_LA %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=sum(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=sum(OPERATING_PROFIT_2022_win), count_PERMITs=n_distinct(PERMIT.y))


# Inside_CA2_LA %>%
#   group_by(fleet) %>%
#   dplyr::summarise(Trips=n(),DOLLAR_2022_win=sum(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=sum(OPERATING_PROFIT_2022_win), count_PERMITs=n_distinct(PERMIT.y))

Inside_CA3_LA %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=sum(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=sum(OPERATING_PROFIT_2022_win), count_PERMITs=n_distinct(PERMIT.y))



dropped_values_CA_1_3_LA %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=sum(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=sum(OPERATING_PROFIT_2022_win), count_PERMITs=n_distinct(PERMIT.y))

```



## Average Winsorized Revenue, VPUE, Operating Profit, and Landings in CA closures by fleet LA 

 Section 4.2 The Adaptive Wind Development Processes -  Central Atlantic - Code chunk below creates output for Table 9. Limited Access (AA) Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for the Central Atlantic region.; Table 10. Limited Access (DAS) Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for the Central Atlantic region.


```{r}
Inside_CA1_LA %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=mean(DOLLAR_2022_win), LANDED_win=mean(LANDED_win),
                   OPERATING_win=mean(OPERATING_PROFIT_2022_win),VPUE_win=mean(VPUE_win) )


# Inside_CA2_LA %>%
#   group_by(fleet) %>%
#  dplyr::summarise(Trips=n(),DOLLAR_2022_win=mean(DOLLAR_2022_win), LANDED_win=mean(LANDED_win),
#                   OPERATING_win=mean(OPERATING_PROFIT_2022_win),VPUE_win=mean(VPUE_win) )


Inside_CA3_LA %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=mean(DOLLAR_2022_win), LANDED_win=mean(LANDED_win),
                   OPERATING_win=mean(OPERATING_PROFIT_2022_win),VPUE_win=mean(VPUE_win) )

dropped_values_CA_1_3_LA %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=mean(DOLLAR_2022_win), LANDED_win=mean(LANDED_win),
                   OPERATING_win=mean(OPERATING_PROFIT_2022_win),VPUE_win=mean(VPUE_win) )


# dropped_values_CA_1_2_LA %>%
#   group_by(fleet) %>%
#  dplyr::summarise(Trips=n(),DOLLAR_2022_win=mean(DOLLAR_2022_win), LANDED_win=mean(LANDED_win),
#                   OPERATING_win=mean(OPERATING_PROFIT_2022_win),VPUE_win=mean(VPUE_win) )
# 
# 
# dropped_values_CA_2_3_LA %>%
#   group_by(fleet) %>%
#   dplyr::summarise(Trips=n(),DOLLAR_2022_win=mean(DOLLAR_2022_win),VPUE_win=mean(VPUE_win),
#                    LANDED_win=mean(LANDED_win), OPERATING_win=mean(OPERATING_PROFIT_2022_win) )


```

## Aggregate Scallop revenue CA1, CA2, and CA3 and the Dropped Values from 1-3 for the GCIFQ Fleet

```{r}


Inside_CA1_GC %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=sum(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=sum(OPERATING_PROFIT_2022_win), count_PERMITs=n_distinct(PERMIT.y))


# Inside_CA2_GC %>%
#   group_by(fleet) %>%
#   dplyr::summarise(Trips=n(),DOLLAR_2022_win=sum(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=sum(OPERATING_PROFIT_2022_win), count_PERMITs=n_distinct(PERMIT.y))

Inside_CA3_GC %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=sum(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=sum(OPERATING_PROFIT_2022_win), count_PERMITs=n_distinct(PERMIT.y))



dropped_values_CA_1_3_GC %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=sum(DOLLAR_2022_win),OPERATING_PROFIT_2022_win=sum(OPERATING_PROFIT_2022_win), count_PERMITs=n_distinct(PERMIT.y))

```

##Average Winsorized Revenue, VPUE, Operating Profit, and Landed weights for the Central Atlantic, GCIFQ

 Section 4.2 The Adaptive Wind Development Processes -  Central Atlantic - Code chunk below creates output for Table 8. GC-IFQ Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for the Central Atlantic region.


```{r}

Inside_CA1_GC %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=mean(DOLLAR_2022_win),LANDED_win=mean(LANDED_win), 
                  OPERATING_win=mean(OPERATING_PROFIT_2022_win), VPUE_win=mean(VPUE_win)  )


# Inside_CA2_GC %>%
#   group_by(fleet) %>%
#  dplyr::summarise(Trips=n(),DOLLAR_2022_win=mean(DOLLAR_2022_win),LANDED_win=mean(LANDED_win), 
#                  OPERATING_win=mean(OPERATING_PROFIT_2022_win), VPUE_win=mean(VPUE_win)  )


Inside_CA3_GC %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=mean(DOLLAR_2022_win),LANDED_win=mean(LANDED_win), 
                  OPERATING_win=mean(OPERATING_PROFIT_2022_win), VPUE_win=mean(VPUE_win)  )



dropped_values_CA_1_3_GC %>%
  group_by(fleet) %>%
  dplyr::summarise(Trips=n(),DOLLAR_2022_win=mean(DOLLAR_2022_win),LANDED_win=mean(LANDED_win), 
                  OPERATING_win=mean(OPERATING_PROFIT_2022_win), VPUE_win=mean(VPUE_win)  )


# dropped_values_CA_1_2_GC %>%
#   group_by(fleet) %>%
#  dplyr::summarise(Trips=n(),DOLLAR_2022_win=mean(DOLLAR_2022_win),LANDED_win=mean(LANDED_win), 
#                  OPERATING_win=mean(OPERATING_PROFIT_2022_win), VPUE_win=mean(VPUE_win)  )
# 
# 
# dropped_values_CA_2_3_GC %>%
#   group_by(fleet) %>%
#  dplyr::summarise(Trips=n(),DOLLAR_2022_win=mean(DOLLAR_2022_win),LANDED_win=mean(LANDED_win), 
#                  OPERATING_win=mean(OPERATING_PROFIT_2022_win), VPUE_win=mean(VPUE_win)  )


```


## CA GC-IFQ Revenue Z-Tests

 Section 4.2 The Adaptive Wind Development Processes -  Central Atlantic - Code chunk below creates output for Table 8. GC-IFQ Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for the Central Atlantic region.


The first command tests the equality Winsorized Dollars for the Trips that were dropped during the CA 1 to CA 3 process (Call area to Lease Area)  against the trips that remained inside at the CA3 step (Lease Areas).  These are done at the 90, 95, and 99\% confidence levels.  Other commands are defined analgously.

```{r, CA1_to_3GC_Dollar_tests}

BSDA::z.test(dropped_values_CA_1_3_GC$DOLLAR_2022_win,
  y = Inside_CA3_GC$DOLLAR_2022_win,
  sigma.x = sd(dropped_values_CA_1_3_GC$DOLLAR_2022_win),
  sigma.y = sd(Inside_CA3_GC$DOLLAR_2022_win),
  alternative = c("two.sided"),
  conf.level = 0.99)

```


## CA Limited Access Revenue Z-Tests

Section 4.2 The Adaptive Wind Development Processes -  Central Atlantic - Code chunk below creates output for Table 9. Limited Access (AA) Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for the Central Atlantic region.; Table 10. Limited Access (DAS) Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for the Central Atlantic region.


```{r, CA1_to_3AA_Dollar_tests}

## Phase 1 to 3

BSDA::z.test(dropped_values_CA_1_3_AA$DOLLAR_2022_win,
  y = Inside_CA3_AA$DOLLAR_2022_win,
  sigma.x = sd(dropped_values_CA_1_3_AA$DOLLAR_2022_win),
  sigma.y = sd(Inside_CA3_AA$DOLLAR_2022_win),
  alternative = c("two.sided"),
  conf.level = 0.99)


## Phase 1 to 3

BSDA::z.test(dropped_values_CA_1_3_DAS$DOLLAR_2022_win,
  y = Inside_CA3_DAS$DOLLAR_2022_win,
  sigma.x = sd(dropped_values_CA_1_3_DAS$DOLLAR_2022_win),
  sigma.y = sd(Inside_CA3_DAS$DOLLAR_2022_win),
  alternative = c("two.sided"),
  conf.level = 0.99)

```

## CA GC-IFQ Landed z-tests

 Section 4.2 The Adaptive Wind Development Processes -  Central Atlantic - Code chunk below creates output for Table 8. GC-IFQ Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for the Central Atlantic region.

```{r, CA1_to_3GC_Landed_tests}


BSDA::z.test(dropped_values_CA_1_3_GC$LANDED_win,
  y = Inside_CA3_GC$LANDED_win,
  sigma.x = sd(dropped_values_CA_1_3_GC$LANDED_win),
  sigma.y = sd(Inside_CA3_GC$LANDED_win),
  alternative = c("two.sided"),
  conf.level = 0.99)


```


## CA Limited Access Landed z-tests

 Section 4.2 The Adaptive Wind Development Processes -  Central Atlantic - Code chunk below creates output for Table 9. Limited Access (AA) Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for the Central Atlantic region.; Table 10. Limited Access (DAS) Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for the Central Atlantic region.


```{r, CA1_to_3AA_Landed_tests}

## Phase 1 to 3

BSDA::z.test(dropped_values_CA_1_3_AA$LANDED_win,
  y = Inside_CA3_AA$LANDED_win,
  sigma.x = sd(dropped_values_CA_1_3_AA$LANDED_win),
  sigma.y = sd(Inside_CA3_AA$LANDED_win),
  alternative = c("two.sided"),
  conf.level = 0.99)



# Days-at-Sea
## Phase 1 to 3

BSDA::z.test(dropped_values_CA_1_3_DAS$LANDED_win,
  y = Inside_CA3_DAS$LANDED_win,
  sigma.x = sd(dropped_values_CA_1_3_DAS$LANDED_win),
  sigma.y = sd(Inside_CA3_DAS$LANDED_win),
  alternative = c("two.sided"),
  conf.level = 0.99)



```


## CA GCIFQ Operating Profit z-tests

 Section 4.2 The Adaptive Wind Development Processes -  Central Atlantic - Code chunk below creates output for Table 8. GC-IFQ Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for the Central Atlantic region.


```{r, CA1_to_3GC_OperatingProfit_tests}

BSDA::z.test(dropped_values_CA_1_3_GC$OPERATING_PROFIT_2022_win,
  y = Inside_CA3_GC$OPERATING_PROFIT_2022_win,
  sigma.x = sd(dropped_values_CA_1_3_GC$OPERATING_PROFIT_2022_win),
  sigma.y = sd(Inside_CA3_GC$OPERATING_PROFIT_2022_win),
  alternative = c("two.sided"),
  conf.level = 0.99)
```

## CA Limited Access Operating Profit z-tests

 Section 4.2 The Adaptive Wind Development Processes -  Central Atlantic - Code chunk below creates output for Table 9. Limited Access (AA) Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for the Central Atlantic region.; Table 10. Limited Access (DAS) Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for the Central Atlantic region.


```{r, CA1_to_3AA_OperatingProfit_tests}

# Access Area 
## Phase 1 to 3

BSDA::z.test(dropped_values_CA_1_3_AA$OPERATING_PROFIT_2022_win,
  y = Inside_CA3_AA$OPERATING_PROFIT_2022_win,
  sigma.x = sd(dropped_values_CA_1_3_AA$OPERATING_PROFIT_2022_win),
  sigma.y = sd(Inside_CA3_AA$OPERATING_PROFIT_2022_win),
  alternative = c("two.sided"),
  conf.level = 0.99)



# Days-at-Sea

## Phase 1 to 3

BSDA::z.test(dropped_values_CA_1_3_DAS$OPERATING_PROFIT_2022_win,
  y = Inside_CA3_DAS$OPERATING_PROFIT_2022_win,
  sigma.x = sd(dropped_values_CA_1_3_DAS$OPERATING_PROFIT_2022_win),
  sigma.y = sd(Inside_CA3_DAS$OPERATING_PROFIT_2022_win),
  alternative = c("two.sided"),
  conf.level = 0.99)




```


## CA GCIFQ z-tests VPUE

 Section 4.2 The Adaptive Wind Development Processes -  Central Atlantic - Code chunk below creates output for Table 8. GC-IFQ Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for the Central Atlantic region.


```{r, CA1_to_3GC_VPUE_tests}

BSDA::z.test(dropped_values_CA_1_3_GC$VPUE_win,
  y = Inside_CA3_GC$VPUE_win,
  sigma.x = sd(dropped_values_CA_1_3_GC$VPUE_win),
  sigma.y = sd(Inside_CA3_GC$VPUE_win),
  alternative = c("two.sided"),
  conf.level = 0.99)

```

## CA Limited Access z-tests VPUE

 Section 4.2 The Adaptive Wind Development Processes -  Central Atlantic - Code chunk below creates output for Table 9. Limited Access (AA) Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for the Central Atlantic region.; Table 10. Limited Access (DAS) Scallop trips, average scallop revenue, average landings, average operating profit, and average revenue per day for the Central Atlantic region.


```{r, CA1_to_3AA_VPUE_tests}

# Access Area 
## Phase 1 to 3
BSDA::z.test(dropped_values_CA_1_3_AA$VPUE_win,
  y = Inside_CA3_AA$VPUE_win,
  sigma.x = sd(dropped_values_CA_1_3_AA$VPUE_win),
  sigma.y = sd(Inside_CA3_AA$VPUE_win),
  alternative = c("two.sided"),
  conf.level = 0.99)




# Days-at-Sea

## Phase 1 to 3
BSDA::z.test(dropped_values_CA_1_3_DAS$VPUE_win,
  y = Inside_CA3_DAS$VPUE_win,
  sigma.x = sd(dropped_values_CA_1_3_DAS$VPUE_win),
  sigma.y = sd(Inside_CA3_DAS$VPUE_win),
  alternative = c("two.sided"),
  conf.level = 0.99)





```


